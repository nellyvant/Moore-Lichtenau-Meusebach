# Trocken, Normalwasser, Hochwasser definieren
Wassertiefen <- Wassertiefen %>%
mutate(
Trocken = Wassertiefe_interp < 3,
Normalwasser = Wassertiefe_interp >= 3 & Wassertiefe_interp <= 25,
Hochwasser = Wassertiefe_interp > 25
)
# Zusammenhängende Perioden identifizieren
Wassertiefen <- Wassertiefen %>%
group_by(Standort, Messpunkt) %>%
mutate(
Trocken_grp = cumsum(Trocken != lag(Trocken, default=first(Trocken))),
Hochwasser_grp = cumsum(Hochwasser != lag(Hochwasser, default=first(Hochwasser)))
) %>%
ungroup()
# Zusammenhängende Perioden zählen
Perioden_Anzahl <- Wassertiefen %>%
group_by(Standort, Messpunkt) %>%
summarise(
TrockenPerioden = sum(Trocken & !duplicated(Trocken_grp)),
HochwasserPerioden = sum(Hochwasser & !duplicated(Hochwasser_grp)),
.groups = "drop"
)
Perioden_Anzahl
# Zusammenhängende Perioden identifizieren
Wassertiefen <- Wassertiefen %>%
group_by(Standort, Messpunkt) %>%
mutate(
Trocken_grp = cumsum(Trocken != lag(Trocken, default=first(Trocken))),
Normalwasser_grp = cumsum(Normalwasser != lag(Normalwasser, default=first(Normalwasser))),
Hochwasser_grp = cumsum(Hochwasser != lag(Hochwasser, default=first(Hochwasser)))
) %>%
ungroup()
# Zusammenhängende Perioden zählen
Perioden_Anzahl <- Wassertiefen %>%
group_by(Standort, Messpunkt) %>%
summarise(
TrockenPerioden = sum(Trocken & !duplicated(Trocken_grp)),
NormalwasserPerioden = sum(Normalwasser & !duplicated(Normalwasser_grp)),
HochwasserPerioden = sum(Hochwasser & !duplicated(Hochwasser_grp)),
.groups = "drop"
)
Perioden_Anzahl
TrockenPerioden <- Wassertiefen %>%
filter(Trocken) %>%  # nur Trockenblöcke
group_by(Standort, Messpunkt, Trocken_grp) %>%  # nach zusammenhängenden Perioden
summarise(
Start = min(Datum),  # erster Tag der Periode
Ende = max(Datum),   # letzter Tag der Periode
Dauer_Tage = as.numeric(max(Datum) - min(Datum)) + 1,  # Dauer in Tagen
.groups = "drop"
)
TrockenPerioden
# Daten nach Datum sortieren und interpolieren
Wassertiefen <- Wassertiefen %>%
arrange(Standort, Messpunkt, Datum) %>%
group_by(Standort, Messpunkt) %>%
mutate(Wassertiefe_interp = na.approx(Wassertiefe, x = as.numeric(Datum))) %>%
ungroup()
# Trocken, Normalwasser, Hochwasser definieren
# Beispielwerte, noch keine konkreten festgelegt
Wassertiefen <- Wassertiefen %>%
mutate(
Trocken = Wassertiefe_interp < 3,
Normalwasser = Wassertiefe_interp >= 3 & Wassertiefe_interp <= 25,
Hochwasser = Wassertiefe_interp > 25
)
# Zusammenhängende Perioden identifizieren
Wassertiefen <- Wassertiefen %>%
group_by(Standort, Messpunkt) %>%
mutate(
Trocken_grp = cumsum(Trocken != lag(Trocken, default=first(Trocken))),
Normalwasser_grp = cumsum(Normalwasser != lag(Normalwasser, default=first(Normalwasser))),
Hochwasser_grp = cumsum(Hochwasser != lag(Hochwasser, default=first(Hochwasser)))
) %>%
ungroup()
# Zusammenhängende Perioden zählen
Perioden_Anzahl <- Wassertiefen %>%
group_by(Standort, Messpunkt) %>%
summarise(
TrockenPerioden = sum(Trocken & !duplicated(Trocken_grp)),
NormalwasserPerioden = sum(Normalwasser & !duplicated(Normalwasser_grp)),
HochwasserPerioden = sum(Hochwasser & !duplicated(Hochwasser_grp)),
.groups = "drop"
)
Perioden_Anzahl
TrockenPerioden <- Wassertiefen %>%
filter(Trocken) %>%  # nur Trockenblöcke
group_by(Standort, Messpunkt, Trocken_grp) %>%  # nach zusammenhängenden Perioden
summarise(
Start = min(Datum),  # erster Tag der Periode
Ende = max(Datum),   # letzter Tag der Periode
Dauer_Tage = as.numeric(max(Datum) - min(Datum)) + 1,  # Dauer in Tagen
.groups = "drop"
)
HochwasserPerioden <- Wassertiefen %>%
filter(Hochwasser) %>%  # nur Hochwasserblöcke
group_by(Standort, Messpunkt, Hochwasser_grp) %>%
summarise(
Start = min(Datum),
Ende = max(Datum),
Dauer_Tage = as.numeric(max(Datum) - min(Datum)) + 1,
.groups = "drop"
)
HochwasserPerioden
View(HochwasserPerioden)
NormalwasserPerioden
NormalwasserPerioden <- Wassertiefen %>%
filter(Normalwasser) %>%  # nur Normalwasserblöcke
group_by(Standort, Messpunkt) %>%
# zusammenhängende Perioden identifizieren
mutate(Normalwasser_grp = cumsum(Normalwasser != lag(Normalwasser, default=first(Normalwasser)))) %>%
group_by(Standort, Messpunkt, Normalwasser_grp) %>%
summarise(
Start = min(Datum),             # erster Tag der Periode
Ende = max(Datum),              # letzter Tag der Periode
Dauer_Tage = as.numeric(max(Datum) - min(Datum)) + 1,
.groups = "drop"
)
NormalwasserPerioden
View(NormalwasserPerioden)
View(HochwasserPerioden)
Wassertiefen <- Wassertiefen %>%
arrange(Standort, Messpunkt, Datum) %>%
group_by(Standort, Messpunkt) %>%
mutate(Wassertiefe_interp = na.approx(Wassertiefe, x = as.numeric(Datum))) %>%
ungroup()
# Trocken, Normalwasser, Hochwasser definieren
# Beispielwerte, noch keine konkreten festgelegt
Wassertiefen <- Wassertiefen %>%
mutate(
Trocken = Wassertiefe_interp < 3,
Normalwasser = Wassertiefe_interp >= 3 & Wassertiefe_interp <= 25,
Hochwasser = Wassertiefe_interp > 25
)
# Zusammenhängende Perioden identifizieren
Wassertiefen <- Wassertiefen %>%
group_by(Standort, Messpunkt) %>%
mutate(
Trocken_grp = cumsum(Trocken != lag(Trocken, default=first(Trocken))),
Normalwasser_grp = cumsum(Normalwasser != lag(Normalwasser, default=first(Normalwasser))),
Hochwasser_grp = cumsum(Hochwasser != lag(Hochwasser, default=first(Hochwasser)))
) %>%
ungroup()
# Zusammenhängende Perioden zählen
Perioden_Anzahl <- Wassertiefen %>%
group_by(Standort, Messpunkt) %>%
summarise(
TrockenPerioden = sum(Trocken & !duplicated(Trocken_grp)),
NormalwasserPerioden = sum(Normalwasser & !duplicated(Normalwasser_grp)),
HochwasserPerioden = sum(Hochwasser & !duplicated(Hochwasser_grp)),
.groups = "drop"
)
Perioden_Anzahl
View(NormalwasserPerioden)
TrockenPerioden <- Wassertiefen %>%
filter(Trocken) %>%  # nur Trockenblöcke
group_by(Standort, Messpunkt, Trocken_grp) %>%  # nach zusammenhängenden Perioden
summarise(
Start = min(Datum),  # erster Tag der Periode
Ende = max(Datum),   # letzter Tag der Periode
Dauer_Tage = as.numeric(max(Datum) - min(Datum)) + 1,  # Dauer in Tagen
.groups = "drop"
)
HochwasserPerioden <- Wassertiefen %>%
filter(Hochwasser) %>%  # nur Hochwasserblöcke
group_by(Standort, Messpunkt, Hochwasser_grp) %>%
summarise(
Start = min(Datum),
Ende = max(Datum),
Dauer_Tage = as.numeric(max(Datum) - min(Datum)) + 1,
.groups = "drop"
)
NormalwasserPerioden <- Wassertiefen %>%
filter(Normalwasser) %>%  # nur Normalwasserblöcke
group_by(Standort, Messpunkt) %>%
# zusammenhängende Perioden identifizieren
mutate(Normalwasser_grp = cumsum(Normalwasser != lag(Normalwasser, default=first(Normalwasser)))) %>%
group_by(Standort, Messpunkt, Normalwasser_grp) %>%
summarise(
Start = min(Datum),             # erster Tag der Periode
Ende = max(Datum),              # letzter Tag der Periode
Dauer_Tage = as.numeric(max(Datum) - min(Datum)) + 1,
.groups = "drop"
)
View(NormalwasserPerioden)
View(HochwasserPerioden)
# Trocken- oder Hochwasserperioden zählen
# Interpolation (da der Wasserstand nicht kontinuirlich gemessen wurde/in regelmäßigen Abständen)
library(zoo)
# Daten nach Datum sortieren und interpolieren
Wassertiefen <- Wassertiefen %>%
arrange(Standort, Messpunkt, Datum) %>%
group_by(Standort, Messpunkt) %>%
mutate(Wassertiefe_interp = na.approx(Wassertiefe, x = as.numeric(Datum))) %>%
ungroup()
# Trocken, Normalwasser, Hochwasser definieren
# Beispielwerte, noch keine konkreten festgelegt
Wassertiefen <- Wassertiefen %>%
mutate(
Trocken = Wassertiefe_interp < 3,
Normalwasser = Wassertiefe_interp >= 3 & Wassertiefe_interp <= 25,
Hochwasser = Wassertiefe_interp > 25
)
# Zusammenhängende Perioden identifizieren
Wassertiefen <- Wassertiefen %>%
group_by(Standort, Messpunkt) %>%
mutate(
Trocken_grp = cumsum(Trocken != lag(Trocken, default=first(Trocken))),
Normalwasser_grp = cumsum(Normalwasser != lag(Normalwasser, default=first(Normalwasser))),
Hochwasser_grp = cumsum(Hochwasser != lag(Hochwasser, default=first(Hochwasser)))
) %>%
ungroup()
# Zusammenhängende Perioden zählen
Perioden_Anzahl <- Wassertiefen %>%
group_by(Standort, Messpunkt) %>%
summarise(
TrockenPerioden = sum(Trocken & !duplicated(Trocken_grp)),
NormalwasserPerioden = sum(Normalwasser & !duplicated(Normalwasser_grp)),
HochwasserPerioden = sum(Hochwasser & !duplicated(Hochwasser_grp)),
.groups = "drop"
)
Perioden_Anzahl
###########################
TrockenPerioden <- Wassertiefen %>%
filter(Trocken) %>%  # nur Trockenblöcke
group_by(Standort, Messpunkt, Trocken_grp) %>%  # nach zusammenhängenden Perioden
summarise(
Start = min(Datum),  # erster Tag der Periode
Ende = max(Datum),   # letzter Tag der Periode
Dauer_Tage = as.numeric(max(Datum) - min(Datum)) + 1,  # Dauer in Tagen
.groups = "drop"
)
HochwasserPerioden <- Wassertiefen %>%
filter(Hochwasser) %>%  # nur Hochwasserblöcke
group_by(Standort, Messpunkt, Hochwasser_grp) %>%
summarise(
Start = min(Datum),
Ende = max(Datum),
Dauer_Tage = as.numeric(max(Datum) - min(Datum)) + 1,
.groups = "drop"
)
NormalwasserPerioden <- Wassertiefen %>%
filter(Normalwasser) %>%  # nur Normalwasserblöcke
group_by(Standort, Messpunkt, Normalwasser_grp) %>%  # bereits vorhanden!
summarise(
Start = min(Datum),
Ende = max(Datum),
Dauer_Tage = as.numeric(max(Datum) - min(Datum)) + 1,
.groups = "drop"
)
TrockenPerioden
HochwasserPerioden
NormalwasserPerioden
View(NormalwasserPerioden)
# Trocken- oder Hochwasserperioden zählen
# Interpolation (da der Wasserstand nicht kontinuirlich gemessen wurde/in regelmäßigen Abständen)
library(zoo)
# Daten nach Datum sortieren und interpolieren
Wassertiefen <- Wassertiefen %>%
arrange(Standort, Messpunkt, Datum) %>%
group_by(Standort, Messpunkt) %>%
mutate(Wassertiefe_interp = na.approx(Wassertiefe, x = as.numeric(Datum))) %>%
ungroup()
# Trocken, Normalwasser, Hochwasser definieren
# Beispielwerte, noch keine konkreten festgelegt
Wassertiefen <- Wassertiefen %>%
mutate(
Trocken = Wassertiefe_interp < 3,
Normalwasser = Wassertiefe_interp >= 3 & Wassertiefe_interp <= 25,
Hochwasser = Wassertiefe_interp > 25
)
# Zusammenhängende Perioden identifizieren
Wassertiefen <- Wassertiefen %>%
group_by(Standort, Messpunkt) %>%
mutate(
Trocken_grp = cumsum(Trocken != lag(Trocken, default=first(Trocken))),
Normalwasser_grp = cumsum(Normalwasser != lag(Normalwasser, default=first(Normalwasser))),
Hochwasser_grp = cumsum(Hochwasser != lag(Hochwasser, default=first(Hochwasser)))
) %>%
ungroup()
# Zusammenhängende Perioden zählen
Perioden_Anzahl <- Wassertiefen %>%
group_by(Standort, Messpunkt) %>%
summarise(
TrockenPerioden = sum(Trocken & !duplicated(Trocken_grp)),
NormalwasserPerioden = sum(Normalwasser & !duplicated(Normalwasser_grp)),
HochwasserPerioden = sum(Hochwasser & !duplicated(Hochwasser_grp)),
.groups = "drop"
)
Perioden_Anzahl
TrockenPerioden <- Wassertiefen %>%
filter(Trocken) %>%  # nur Trockenblöcke
group_by(Standort, Messpunkt, Trocken_grp) %>%  # nach zusammenhängenden Perioden
summarise(
Start = min(Datum),  # erster Tag der Periode
Ende = max(Datum),   # letzter Tag der Periode
Dauer_Tage = as.numeric(max(Datum) - min(Datum)) + 1,  # Dauer in Tagen
.groups = "drop"
)
TrockenPerioden
HochwasserPerioden <- Wassertiefen %>%
filter(Hochwasser) %>%  # nur Hochwasserblöcke
group_by(Standort, Messpunkt, Hochwasser_grp) %>%
summarise(
Start = min(Datum),
Ende = max(Datum),
Dauer_Tage = as.numeric(max(Datum) - min(Datum)) + 1,
.groups = "drop"
)
HochwasserPerioden
NormalwasserPerioden <- Wassertiefen %>%
filter(Normalwasser) %>%  # nur Normalwasserblöcke
group_by(Standort, Messpunkt, Normalwasser_grp) %>%  # bereits vorhanden!
summarise(
Start = min(Datum),
Ende = max(Datum),
Dauer_Tage = as.numeric(max(Datum) - min(Datum)) + 1,
.groups = "drop"
)
NormalwasserPerioden
View(Perioden_Anzahl)
View(HochwasserPerioden)
View(NormalwasserPerioden)
View(HochwasserPerioden)
library(zoo)  # für rollmean
Wassertiefen <- Wassertiefen %>%
group_by(Standort, Messpunkt) %>%
arrange(Datum) %>%
mutate(Wasserstand_SMA = rollmean(Wassertiefe, k = 3, fill = NA))
ggplot(wasser, aes(x = Datum, y = Wasserstand_SMA, color = Messpunkt)) +
geom_line() +
facet_wrap(~Standort) +
theme_minimal() +
labs(title="Gleitender Mittelwert der Wasserstände",
y="Wasserstand (cm)", x="Datum")
ggplot(Wassertiefen, aes(x = Datum, y = Wasserstand_SMA, color = Messpunkt)) +
geom_line() +
facet_wrap(~Standort) +
theme_minimal() +
labs(title="Gleitender Mittelwert der Wasserstände",
y="Wasserstand (cm)", x="Datum")
ggplot(Wassertiefen, aes(x=Wassertiefe, fill=Standort)) +
geom_histogram(binwidth=5, alpha=0.5, position="identity") +
theme_minimal()
ggplot(Wassertiefen, aes(x = Wassertiefe, fill = Standort)) +
geom_histogram(binwidth = 5, alpha = 0.7) +
facet_wrap(~Standort) +
theme_minimal() +
labs(title = "Verteilung der Wasserstände pro Standort",
x = "Wasserstand (cm)",
y = "Anzahl der Messungen")
# Histogramm zur Häufigkeit der Wasserstände je Messpunkt und Standort
standort_L <- Wassertiefen %>%
filter(Standort == "L")
ggplot(standort_L, aes(x = Wassertiefe, fill = Messpunkte)) +
geom_histogram(binwidth = 5, alpha = 0.7) +
facet_wrap(~Messpunkte) +
theme_minimal() +
labs(title = "Verteilung der Wasserstände pro Standort",
x = "Wasserstand (cm)",
y = "Anzahl der Messungen")
# Histogramm zur Häufigkeit der Wasserstände je Messpunkt und Standort
standort_L <- Wassertiefen %>%
filter(Standort == "L")
ggplot(standort_L, aes(x = Wassertiefe, fill = Messpunkt)) +
geom_histogram(binwidth = 5, alpha = 0.7) +
facet_wrap(~Messpunkt) +
theme_minimal() +
labs(title = "Histogramm pro Messpunkt - Standort L",
x = "Wasserstand (cm)",
y = "Anzahl Messungen")
ggplot(standort_L, aes(x = Wassertiefe, fill = Messpunkt)) +
geom_histogram(binwidth = 5, alpha = 0.7) +
facet_wrap(~Messpunkt) +
#theme_minimal() +
labs(title = "Histogramm pro Messpunkt - Standort L",
x = "Wasserstand (cm)",
y = "Anzahl Messungen")
ggplot(standort_L, aes(x = Wassertiefe, fill = Messpunkt)) +
geom_histogram(binwidth = 5, alpha = 0.7) +
facet_wrap(~Messpunkt) +
theme_minimal() +
labs(title = "Histogramm pro Messpunkt - Standort L",
x = "Wasserstand (cm)",
y = "Anzahl Messungen")
standort_MN <- Wassertiefen %>%
filter(Standort == "MN")
standort_MT <- Wassertiefen %>%
filter(Standort == "MT")
ggplot(standort_MT, aes(x = Wassertiefe, fill = Messpunkt)) +
geom_histogram(binwidth = 5, alpha = 0.7) +
facet_wrap(~Messpunkt) +
theme_minimal() +
labs(title = "Histogramm pro Messpunkt - Standort L",
x = "Wasserstand (cm)",
y = "Anzahl Messungen")
ggplot(standort_MT, aes(x = Wassertiefe, fill = Messpunkt)) +
geom_histogram(binwidth = 2, alpha = 0.7) +
facet_wrap(~Messpunkt) +
theme_minimal() +
labs(title = "Histogramm pro Messpunkt - Standort L",
x = "Wasserstand (cm)",
y = "Anzahl Messungen")
ggplot(standort_MT, aes(x = Wassertiefe, fill = Messpunkt)) +
geom_histogram(binwidth = 3, alpha = 0.7) +
facet_wrap(~Messpunkt) +
theme_minimal() +
labs(title = "Histogramm pro Messpunkt - Standort L",
x = "Wasserstand (cm)",
y = "Anzahl Messungen")
# Histogramm zur Häufigkeit der Wasserstände je Messpunkt und Standort
Wassertiefen$Standort <- as.factor(Wassertiefen$Standort)
Wassertiefen$Messpunkt <- as.factor(Wassertiefen$Messpunkt)
standort_L <- Wassertiefen %>%
filter(Standort == "L")
standort_MN <- Wassertiefen %>%
filter(Standort == "MN")
standort_MT <- Wassertiefen %>%
filter(Standort == "MT")
ggplot(standort_MT, aes(x = Wassertiefe, fill = Messpunkt)) +
geom_histogram(binwidth = 3, alpha = 0.7) +
facet_wrap(~Messpunkt) +
theme_minimal() +
labs(title = "Histogramm pro Messpunkt - Standort L",
x = "Wasserstand (cm)",
y = "Anzahl Messungen")
ggplot(standort_MT, aes(x = Wassertiefe, fill = Messpunkt)) +
geom_histogram(binwidth = 3, alpha = 0.7) +
facet_wrap(~Messpunkt) +
theme_minimal() +
labs(title = "Histogramm pro Messpunkt & Standort",
x = "Wasserstand (cm)",
y = "Anzahl Messungen")
ggplot(standort_MN, aes(x = Wassertiefe, fill = Messpunkt)) +
geom_histogram(binwidth = 3, alpha = 0.7) +
facet_wrap(~Messpunkt) +
theme_minimal() +
labs(title = "Histogramm pro Messpunkt & Standort",
x = "Wasserstand (cm)",
y = "Anzahl Messungen")
ggplot(standort_MN, aes(x = Wassertiefe, fill = Messpunkt)) +
geom_histogram(binwidth = 4, alpha = 0.7) +
facet_wrap(~Messpunkt) +
theme_minimal() +
labs(title = "Histogramm pro Messpunkt & Standort",
x = "Wasserstand (cm)",
y = "Anzahl Messungen")
ggplot(standort_L, aes(x = Wassertiefe, fill = Messpunkt)) +
geom_histogram(binwidth = 4, alpha = 0.7) +
facet_wrap(~Messpunkt) +
theme_minimal() +
labs(title = "Histogramm pro Messpunkt & Standort",
x = "Wasserstand (cm)",
y = "Anzahl Messungen")
standort_L <- Wassertiefen %>%
filter(Standort == "L", Messpunkt != "3")
ggplot(standort_L, aes(x = Wassertiefe, fill = Messpunkt)) +
geom_histogram(binwidth = 4, alpha = 0.7) +
facet_wrap(~Messpunkt) +
theme_minimal() +
labs(title = "Histogramm pro Messpunkt & Standort",
x = "Wasserstand (cm)",
y = "Anzahl Messungen")
standort_L <- Wassertiefen %>%
filter(Standort == "L", Messpunkt != "4")
ggplot(standort_L, aes(x = Wassertiefe, fill = Messpunkt)) +
geom_histogram(binwidth = 4, alpha = 0.7) +
facet_wrap(~Messpunkt) +
theme_minimal() +
labs(title = "Histogramm pro Messpunkt & Standort",
x = "Wasserstand (cm)",
y = "Anzahl Messungen")
ggplot(standort_L, aes(x = Wassertiefe, fill = Messpunkt)) +
geom_histogram(binwidth = 5, alpha = 0.7) +
facet_wrap(~Messpunkt) +
theme_minimal() +
labs(title = "Histogramm pro Messpunkt & Standort",
x = "Wasserstand (cm)",
y = "Anzahl Messungen")
# Histogramm zur Häufigkeit der Wasserstände je Messpunkt und Standort
Wassertiefen$Standort <- as.factor(Wassertiefen$Standort)
Wassertiefen$Messpunkt <- as.factor(Wassertiefen$Messpunkt)
standort_L <- Wassertiefen %>%
filter(Standort == "L")
#standort_L <- Wassertiefen %>%
filter(Standort == "L", Messpunkt != "4")
# Histogramm zur Häufigkeit der Wasserstände je Messpunkt und Standort
Wassertiefen$Standort <- as.factor(Wassertiefen$Standort)
Wassertiefen$Messpunkt <- as.factor(Wassertiefen$Messpunkt)
standort_L <- Wassertiefen %>%
filter(Standort == "L")
#standort_L <- Wassertiefen %>%
#  filter(Standort == "L", Messpunkt != "4")
standort_MN <- Wassertiefen %>%
filter(Standort == "MN")
standort_MT <- Wassertiefen %>%
filter(Standort == "MT")
ggplot(standort_L, aes(x = Wassertiefe, fill = Messpunkt)) +
geom_histogram(binwidth = 5, alpha = 0.7) +
facet_wrap(~Messpunkt) +
theme_minimal() +
labs(title = "Histogramm pro Messpunkt & Standort",
x = "Wasserstand (cm)",
y = "Anzahl Messungen")
ggplot(standort_MN, aes(x = Wassertiefe, fill = Messpunkt)) +
geom_histogram(binwidth = 5, alpha = 0.7) +
facet_wrap(~Messpunkt) +
theme_minimal() +
labs(title = "Histogramm pro Messpunkt & Standort",
x = "Wasserstand (cm)",
y = "Anzahl Messungen")
